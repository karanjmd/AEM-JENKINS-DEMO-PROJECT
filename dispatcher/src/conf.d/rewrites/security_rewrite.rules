RewriteEngine on 
RewriteCond %{REQUEST_URI} ^(.*)//(.*)$
RewriteRule . %1/%2 [R=301,L]
RewriteCond %{THE_REQUEST} ^.*querybuilder.* [NC,OR]
RewriteCond %{THE_REQUEST} ^.*assetsearch.* [NC,OR]
RewriteCond %{THE_REQUEST} ^.*\.childrenlist\.json* [NC,OR]
RewriteCond %{THE_REQUEST} ^.*/_jcr_content\.html* [NC,OR]
RewriteCond %{THE_REQUEST} ^.*/jcr:content\.html* [NC,OR]
RewriteCond %{THE_REQUEST} ^.*/api\.json* [NC,OR]
RewriteCond %{THE_REQUEST} (^\.|/\.) [NC,OR]
RewriteCond %{THE_REQUEST} ^.*/search\.json* [NC]
RewriteRule . - [F]
RewriteCond %{THE_REQUEST} ^.*autodiscover\.xml.* [NC,OR]
RewriteCond %{REQUEST_URI} ^/system [NC,OR]
RewriteCond %{REQUEST_URI} ^/apps/system [NC,OR]
RewriteCond %{REQUEST_URI} ^/crx [NC,OR]
RewriteCond %{REQUEST_URI} ^/var [NC,OR]
RewriteCond %{REQUEST_URI} ^/home [NC,OR]
RewriteCond %{REQUEST_URI} ^/admin [NC,OR]
RewriteCond %{REQUEST_URI} ^/libs/cq/contentsight [NC,OR]
RewriteCond %{REQUEST_URI} ^/libs/cq/analytics [NC,OR]
RewriteCond %{REQUEST_URI} ^/libs/cq/cloudserviceprovisioning [NC,OR]
RewriteCond %{REQUEST_URI} ^/services/tagfilter [NC,OR]
RewriteCond %{REQUEST_URI} ^/libs/mcm/cwsalesforce [NC,OR]
RewriteCond %{REQUEST_URI} ^/bin/wcm [NC]
RewriteRule . - [L,R=404]
##### uncomment with care can be used if tested
#RewriteCond %{THE_REQUEST} ^.*(\\r|\\n|%0A|%0D|;).* [NC,OR]
# RewriteCond %{REQUEST_URI} ^.*(,|;|<|>|">|"<|\.\.\.).*     [NC,OR]
# RewriteCond %{REQUEST_URI} ^.*(\=|\@|\[|\]|\^|\`|\{|\}|\~).* [NC,OR]
# RewriteCond %{REQUEST_URI} ^.*(\'|%0A|%0D|%27|%3C|%3E|%00).* [NC,OR]
#RewriteCond %{REQUEST_URI} ^.*(%0A|%0D|;\\).* [NC]
# RewriteRule . - [F] 
RewriteCond %{THE_REQUEST} !HTTP/1.1$
RewriteRule .* - [F]

# block potentially bad cookies
 RewriteCond %{HTTP_COOKIE} ^.*(<|>|'|%0A|%0D|%27|%3C|%3E|%00).* [NC]
 RewriteRule ^(.*)$ - [F]
